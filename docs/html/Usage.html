<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Usage &mdash; pyDarwin 2.0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="Examples.html" />
    <link rel="prev" title="Installation" href="Install.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> pyDarwin
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Algorithms.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="Support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="Releases.html">Releases</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#execution-overview">Execution Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-search-on-local-machine">Running search on local machine</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stopping-execution">Stopping Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#execution-on-linux-grids">Execution on Linux Grids</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#running-grid-search">Running Grid Search</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#search-info">Search Info</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#required-files">Required Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#template-file">Template File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#special-notes-on-structure-of-theta-omega-sigma">Special notes on structure of $THETA/$OMEGA/$SIGMA:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tokens-file">Tokens File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#options-file">Options File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#searching-omega-structure">Searching Omega Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#omega-block-search">Omega Block Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="#omega-band-search">Omega Band Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="#omega-submatrices-search">Omega Submatrices Search</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pydarwin-outputs">pyDarwin Outputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#console-output">Console output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-output">File output</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#messages-txt">Messages.txt</a></li>
<li class="toctree-l4"><a class="reference internal" href="#models-json">models.json</a></li>
<li class="toctree-l4"><a class="reference internal" href="#results-csv">results.csv</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#file-structure-and-naming">File Structure and Naming</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#saving-nonmem-outputs">Saving NONMEM outputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-folder-naming">Model/folder naming</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="Options.html">Options List</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="Glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="Troubleshooting.html">Troubleshooting</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyDarwin</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Usage</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h1>
<p id="execution">Darwin may be executed locally, on Linux Grids, or as a combination of both (e.g., execute NONMEM models on grids and run search locally).</p>
<section id="execution-overview">
<h2>Execution Overview<a class="headerlink" href="#execution-overview" title="Permalink to this heading">¶</a></h2>
<section id="running-search-on-local-machine">
<span id="local-execution"></span><h3>Running search on local machine<a class="headerlink" href="#running-search-on-local-machine" title="Permalink to this heading">¶</a></h3>
<p>The <a class="reference internal" href="API.html#darwin-run-search"><span class="std std-ref">darwin.run_search</span></a> function executes the candidate search for the optimal population model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">darwin</span><span class="o">.</span><span class="n">run_search</span> <span class="o">&lt;</span><span class="n">template_path</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">tokens_path</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">options_path</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>To execute, call the <code class="docutils literal notranslate"><span class="pre">darwin.run_search</span></code> function and provide the paths to the following files as arguments:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#template-file-target"><span class="std std-ref">Template file</span></a> (e.g., template.txt) - basic shell for NONMEM control files</p></li>
<li><p><a class="reference internal" href="#tokens-file-target"><span class="std std-ref">Tokens file</span></a> (e.g., tokens.json) - json file describing the dimensions of the search space and the options in each dimension</p></li>
<li><p><a class="reference internal" href="#options-file-target"><span class="std std-ref">Options file</span></a> (e.g., options.json) - json file describing algorithm, run options, and post-run penalty code configurations.</p></li>
</ol>
<p>See <a class="reference internal" href="#startrequiredfiles"><span class="std std-ref">Required Files</span></a> for additional details.</p>
<p id="usage-run-search-in-folder">Alternatively, you may execute the <a class="mono reference internal" href="API.html#darwin-run-search-in-folder"><span class="std std-ref">darwin.run_search_in_folder</span></a> function,
specifying the path to the folder containing the <code class="docutils literal notranslate"><span class="pre">template.txt</span></code>, <code class="docutils literal notranslate"><span class="pre">tokens.json</span></code>, and <code class="docutils literal notranslate"><span class="pre">options.json</span></code> files
as a single argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">darwin</span><span class="o">.</span><span class="n">run_search_in_folder</span> <span class="o">&lt;</span><span class="n">folder_path</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Files must be named as <code class="docutils literal notranslate"><span class="pre">template.txt</span></code>, <code class="docutils literal notranslate"><span class="pre">tokens.json</span></code>, and <code class="docutils literal notranslate"><span class="pre">options.json</span></code> when using <a class="mono reference internal" href="API.html#darwin-run-search-in-folder"><span class="std std-ref">darwin.run_search_in_folder</span></a>.</p>
</div>
</section>
<section id="stopping-execution">
<span id="stop-search"></span><h3>Stopping Execution<a class="headerlink" href="#stopping-execution" title="Permalink to this heading">¶</a></h3>
<p>A running search can be stopped using following command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">darwin</span><span class="o">.</span><span class="n">stop_search</span> <span class="p">[</span><span class="o">-</span><span class="n">f</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">project</span> <span class="nb">dir</span><span class="o">&gt;|&lt;</span><span class="n">options</span> <span class="n">file</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">You need to provide the path to the project folder or to the options file associated with the search you want to stop.</div>
<div class="line">Optional flag specifies whether the search must be stopped immediately. If not set the search will stop after current model runs are finished.</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don’t force-stop GP during the <a class="reference internal" href="Example2.html#gp-ask-tell"><span class="std std-ref">ask stage</span></a>. Either wait for it to finish (<code class="docutils literal notranslate"><span class="pre">Done</span> <span class="pre">asking</span></code> in the console output and/or <code class="file docutils literal notranslate"><span class="pre">messages.txt</span></code>) or stop without <code class="docutils literal notranslate"><span class="pre">-f</span></code> flag.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>models.json will contain all model runs finished before interruption.</p>
</div>
</section>
<section id="execution-on-linux-grids">
<span id="grid-execution"></span><h3>Execution on Linux Grids<a class="headerlink" href="#execution-on-linux-grids" title="Permalink to this heading">¶</a></h3>
<p>The following requirements should be met in order to execute pyDarwin on Linux Grids.</p>
<ul class="simple">
<li><p>You must have access to the grid system (e.g., you are able to connect to the system via terminal session).</p></li>
<li><p>You must make pyDarwin installation available for all grid nodes.</p></li>
<li><p>Your search project must be available for all grid nodes as well.</p></li>
<li><p>You should be familiar with your grid controller commands (e.g., how to submit a job, query finished jobs, and delete jobs).</p></li>
<li><p>You should be familiar with regular expressions e.g., for usage in <code class="docutils literal notranslate"><span class="pre">&quot;submit_job_id_re&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;poll_job_id_re&quot;</span></code> fields in <code class="docutils literal notranslate"><span class="pre">options.json</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If all grid nodes share the same file system, you can simply deploy pyDarwin in your home directory (always use virtual environment!).</p>
</div>
<p>There are two ways to utilize grids for search in pyDarwin:</p>
<ol class="arabic simple">
<li><p>Run search <a class="reference internal" href="#local-execution"><span class="std std-ref">locally</span></a>, submit individual model runs to the grid (local search, grid model runs).</p></li>
<li><p>Submit search <a class="reference internal" href="#running-grid-search"><span class="std std-ref">to the grid</span></a>, as well as all the model runs (grid search, grid model runs).</p></li>
</ol>
<p>In both cases you need to setup grid settings in your <code class="docutils literal notranslate"><span class="pre">options.json</span></code>.</p>
<p>With either case, you can <a class="reference internal" href="#stop-search"><span class="std std-ref">stop the search</span></a> using <code class="docutils literal notranslate"><span class="pre">darwin.stop_search</span></code>. Just keep in mind that in the second case, it may not be very responsive (due to load/IO latency/grid deployment details), so be patient.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although it’s possible to submit a “local search with local model runs” to the grid, this is not suggested.</p>
</div>
<section id="running-grid-search">
<span id="id1"></span><h4>Running Grid Search<a class="headerlink" href="#running-grid-search" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">darwin</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">run_search</span> <span class="o">&lt;</span><span class="n">template_path</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">tokens_path</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">options_path</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Or alternatively, run grid search in folder:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">darwin</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">run_search_in_folder</span> <span class="o">&lt;</span><span class="n">folder_path</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must ensure that <a class="mono reference internal" href="Options.html#submit-search-command-options-desc"><span class="std std-ref">submit_search_command</span></a> has been set up correctly in options.json, in addition to other grid settings.</p>
</div>
</section>
</section>
<section id="search-info">
<span id="id2"></span><h3>Search Info<a class="headerlink" href="#search-info" title="Permalink to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">darwin</span><span class="o">.</span><span class="n">search_info</span> <span class="o">&lt;</span><span class="n">folder_path</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This command loads the search folder and shows the summary that looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Changing</span> <span class="n">directory</span> <span class="n">to</span> <span class="n">c</span><span class="p">:</span>\<span class="n">workspace</span>\<span class="n">fruitfly</span>\<span class="n">examples</span>\<span class="n">NONMEM</span>\<span class="n">user</span>\<span class="n">Example2</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Options</span> <span class="n">file</span> <span class="n">found</span> <span class="n">at</span> <span class="n">options</span><span class="o">.</span><span class="n">json</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Loading</span> <span class="n">system</span> <span class="n">options</span><span class="p">:</span> <span class="n">c</span><span class="p">:</span>\<span class="n">workspace</span>\<span class="n">fruitfly</span>\<span class="n">examples</span>\<span class="n">user</span>\<span class="n">options</span><span class="o">.</span><span class="n">json</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Template</span> <span class="n">file</span> <span class="n">found</span> <span class="n">at</span> <span class="n">template</span><span class="o">.</span><span class="n">txt</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Tokens</span> <span class="n">file</span> <span class="n">found</span> <span class="n">at</span> <span class="n">tokens</span><span class="o">.</span><span class="n">json</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Algorithm</span><span class="p">:</span> <span class="n">GP</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Engine</span><span class="p">:</span> <span class="n">NONMEM</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">random_seed</span><span class="p">:</span> <span class="mi">11</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Project</span> <span class="nb">dir</span><span class="p">:</span> <span class="n">c</span><span class="p">:</span>\<span class="n">workspace</span>\<span class="n">fruitfly</span>\<span class="n">examples</span>\<span class="n">NONMEM</span>\<span class="n">user</span>\<span class="n">Example2</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Data</span> <span class="nb">dir</span><span class="p">:</span> <span class="n">c</span><span class="p">:</span>\<span class="n">workspace</span>\<span class="n">fruitfly</span>\<span class="n">examples</span>\<span class="n">NONMEM</span>\<span class="n">user</span>\<span class="n">Example2</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Project</span> <span class="n">working</span> <span class="nb">dir</span><span class="p">:</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">jcook</span>\<span class="n">pydarwin</span>\<span class="n">Example2</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Project</span> <span class="n">temp</span> <span class="nb">dir</span><span class="p">:</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">jcook</span>\<span class="n">pydarwin</span>\<span class="n">Example2</span>\<span class="n">temp</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Project</span> <span class="n">output</span> <span class="nb">dir</span><span class="p">:</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">jcook</span>\<span class="n">pydarwin</span>\<span class="n">Example2</span>\<span class="n">output</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Key</span> <span class="n">models</span> <span class="nb">dir</span><span class="p">:</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">jcook</span>\<span class="n">pydarwin</span>\<span class="n">Example2</span>\<span class="n">key_models</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Search</span> <span class="n">space</span> <span class="n">size</span><span class="p">:</span> <span class="mi">12960</span>
<span class="p">[</span><span class="mi">01</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="n">Estimated</span> <span class="n">number</span> <span class="n">of</span> <span class="n">models</span> <span class="n">to</span> <span class="n">run</span><span class="p">:</span> <span class="mi">454</span>
</pre></div>
</div>
</section>
</section>
<section id="required-files">
<span id="startrequiredfiles"></span><h2>Required Files<a class="headerlink" href="#required-files" title="Permalink to this heading">¶</a></h2>
<p>The same 3 files are required for any search, whether <a class="reference internal" href="Algorithms.html#ex-desc"><span class="std std-ref">EX</span></a>, <a class="reference internal" href="Algorithms.html#ga-desc"><span class="std std-ref">GA</span></a>,
<a class="reference internal" href="Algorithms.html#gp-desc"><span class="std std-ref">GP</span></a>, <a class="reference internal" href="Algorithms.html#rf-desc"><span class="std std-ref">RF</span></a>, <a class="reference internal" href="Algorithms.html#gbrt-desc"><span class="std std-ref">GBRT</span></a>, or <a class="reference internal" href="Algorithms.html#ex-desc"><span class="std std-ref">PSO</span></a>. Which algorithm is used is defined in the
<a class="reference internal" href="#options-file-target"><span class="std std-ref">options file</span></a>. The template file serves as a framework and looks similar to a
NONMEM/NMTRAN control file. The tokens file specifies the range of “features” to be searched, and the options
file specifies the algorithm, the fitness function, any R or Python code to be executed after the NONMEM execution,
and other options related to execution. See <a class="reference internal" href="Options.html#options"><span class="std std-ref">Options List</span></a>.</p>
<section id="template-file">
<span id="template-file-target"></span><h3>Template File<a class="headerlink" href="#template-file" title="Permalink to this heading">¶</a></h3>
<p>The template file is a plain ASCII text file. This file is the framework for the construction of the NONMEM
control files. Typically, the structure will be quite similar to a NONMEM control file, with the usual
blocks, e.g., $PROB, $INPUT, $DATA, $SUBS, $PK, $ERROR, $THETA, $OMEGA, $SIGMA, $EST. However, this format is
completely flexible and entire blocks may be missing from the template file (to be provided from the
<a class="reference internal" href="#tokens-file-target"><span class="std std-ref">tokens file</span></a>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>NONMEM does not allow the data set path ($DATA) to be longer than 80 characters and the path must be in quotes
if it contains spaces (see <a class="reference internal" href="Glossary.html#data-directory"><span class="std std-ref">Data Directory</span></a>).</p>
</div>
<p>The difference between a standard NONMEM control file and the template file is that the user will define code
segments in the template file that will be replaced by other text. These code segments are referred to as “token keys”.
Token keys come in sets, and in most cases, several token keys will need to be replaced together to generate syntactically
correct code. The syntax for a token key in the template file is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">Token_stem</span><span class="p">[</span><span class="n">N</span><span class="p">]}</span>
</pre></div>
</div>
<p>Where Token_stem is a unique identifier for that token set and N is the target text to be substituted. An
example is instructive.</p>
<p><em>Example:</em></p>
<p>Assume the user would like to consider 1 compartment (ADVAN1) or 2 compartment (ADVAN3) models as a dimension of the search.
The relevant template file for this might be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$SUBS {ADVAN[1]}
.
.
$PK
.
.
.
{ADVAN[2]}
.
.
.
$THETA
(0,1) ; Volume - fixed THETA - always appears
(0,1) ; Clearance - fixed THETA - always appears
{ADVAN[3]}
</pre></div>
</div>
<p>Note that tokens nearly always come in sets. As in nearly all cases, several substitutions must be made to create correct syntax.
For a one compartment model, the following substitutions would be made:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">ADVAN</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span> <span class="o">-&gt;</span> <span class="n">ADVAN1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">ADVAN</span><span class="p">[</span><span class="mi">2</span><span class="p">]}</span> <span class="o">-&gt;</span> <span class="p">;;</span> <span class="mi">1</span> <span class="n">compartment</span><span class="p">,</span> <span class="n">no</span> <span class="n">definition</span> <span class="n">needed</span> <span class="k">for</span> <span class="n">K12</span> <span class="ow">or</span> <span class="n">K21</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">ADVAN</span><span class="p">[</span><span class="mi">3</span><span class="p">]}</span> <span class="o">-&gt;</span> <span class="p">;;</span> <span class="mi">1</span> <span class="n">compartment</span><span class="p">,</span> <span class="n">no</span> <span class="n">initial</span> <span class="n">estimate</span> <span class="n">needed</span> <span class="k">for</span> <span class="n">K12</span> <span class="ow">or</span> <span class="n">K21</span>
</pre></div>
</div>
<p>and for 2 compartment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">ADVAN</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span> <span class="o">-&gt;</span> <span class="n">ADVAN3</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">ADVAN</span><span class="p">[</span><span class="mi">2</span><span class="p">]}</span> <span class="o">-&gt;</span> <span class="n">K12</span> <span class="o">=</span> <span class="n">THETA</span><span class="p">(</span><span class="n">ADVANA</span><span class="p">)</span> <span class="p">;;</span> <span class="mi">2</span> <span class="n">compartment</span><span class="p">,</span> <span class="n">need</span> <span class="n">definition</span> <span class="k">for</span> <span class="n">K12</span> \<span class="n">n</span> <span class="n">K21</span> <span class="o">=</span> <span class="n">THETA</span><span class="p">(</span><span class="n">ADVANB</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ADVAN</span><span class="p">[</span><span class="mi">3</span><span class="p">]}</span> <span class="o">-&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span> <span class="p">;;</span> <span class="n">K12</span> <span class="n">THETA</span><span class="p">(</span><span class="n">ADVANA</span><span class="p">)</span>  \<span class="n">n</span>  <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span> <span class="p">;;</span> <span class="n">K21</span> <span class="n">THETA</span><span class="p">(</span><span class="n">ADVANB</span><span class="p">)</span>
</pre></div>
</div>
<p>Where \n is the new line character. These sets of tokens are called token sets (2 token sets in this example one for ADVAN1, one for ADVAN3). The group of token sets
is called a token group. In this example, “ADVAN” is the token key. Each token group must have a unique token key. For the first set of options, the text “ADVAN1”
is referred to as the token text. Each token set consists of key-text pairs: token keys (described above) and token text.</p>
<p>The token (consisting of “{” + token stem +[N] + “}” where N is an integer specifying which token text in the token set is to be substituted) in the template file is
replaced by the token text, specified in the tokens file. Which set of token key-text pairs is substituted is determined by the search algorithm and provided in
the <a class="reference internal" href="Glossary.html#phenotype"><span class="std std-ref">phenotype.</span></a></p>
<p>Note that the THETA (and ETA and EPS) indices cannot be determined until the final control file is defined, as THETAs may be included in one token set, but missing in another token set.
For this reason, all fixed initial estimates in the $THETA block MUST occur before the THETA values that are not fixed (e.g., are searched). This is so the
algorithm can parse the resulting file and correctly calculate the appropriate THETA (and ETA and EPS) indices. Further, the text string index in the token (e.g., ADVANA and ADVANB)
<em>must</em> be unique in the token groups. The most convenient way to ensure that the text string index is unique in the Token groups is to use the token stem as the
THETA index (e.g., THETA(ADVAN) is the token stem is ADVAN). Additional characters (e.g., ADVANA, ADVANB) can be added if multiple THETA text indices are needed.
Note that the permitted syntax for residual error is EPS() or ERR().</p>
<section id="special-notes-on-structure-of-theta-omega-sigma">
<h4>Special notes on structure of $THETA/$OMEGA/$SIGMA:<a class="headerlink" href="#special-notes-on-structure-of-theta-omega-sigma" title="Permalink to this heading">¶</a></h4>
<p>Parameter initial estimate blocks require special treatment. A template file will typically include 2 types of initial estimates:</p>
<ol class="arabic simple">
<li><p>Fixed initial estimates - Initial estimates that are not searched, but will be copied from the template into <strong>ALL</strong> control files. These are the typical $THETA estimates, e.g.: (0,1)  ; THETA(1) Clearance.</p></li>
<li><p>Searched initial estimates - Initial estimates that are specified in tokens that may or may not be in any given control file, e.g., {ALAG[2]} where the text for the ALAG[2] token key is “(0,1) ;; THETA(ALAG) Absorption lag time”</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Fixed initial estimates <strong>MUST</strong> be placed before searched initial estimates</p>
</div>
<p>pyDarwin automatically determines the correct indices for any THETA/OMEGA/SIGMA elements that are part of the search options.
In order to correctly number these, it first must determine the number of “fixed” (i.e., present in all models, not searched) elements for each.
For this reason, the fixed elements of THETA/OMEGA/SIGMA must come before any searched elements in the $THETA/$OMEGA/$SIGMA blocks.
pyDarwin counts the number of fixed initial estimates in (for example) the $THETA block, then starts numbering the searched THETAs with the next consecutive number.
As is the case for NONMEM, the indices for fixed THETAs are determined entirely by their position in the $THETA block. That is, if the $THETA block is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$THETA
0.1
0.1
0.1
</pre></div>
</div>
<p>These will be THETA(1) to THETA(3) and pyDarwin will start with an index of 4.
Errors would occur if pyDarwin simply counted the number THETA/ETA/EPS values in the $PK, $ERROR, $MIX, $AES and $DES block if, for example, fixed THETAs were used in $THETA and they did not appear in $PK.
Therefore, the sequencing of THETA/ETA/EPS indices is based on the values and positions in the initial values blocks.
In addition, to correctly number the elements, pyDarwin needs a little more help finding the correct indices. Specifically, comments (text after a ‘;’) in the $THETA block and THETA initial estimate tokens MUST be used.
If this text is not present, and more than one initial estimate was used in a token set (e.g., CL=THETA(VMAX)*CONC/(THETA(KM)+CONC), pyDarwin would not know which initial estimate is to be associated with THETA(EMAX) and which with THETA(KM).</p>
<p>Generally, it is less confusing to have a separate line for each initial estimate, with a comment for that initial estimate.
However, multiple initial estimates can be put on a single line, with multiple ‘;’ separating the defining text (please ensure that you are following naming conventions outlined below).</p>
<p>Specifically, there are 3 ways to define a variable name (ETA/THETA/OMEGA):</p>
<ol class="arabic simple">
<li><p>; NAME (any amount of spaces before and after name)</p></li>
<li><p>; any text ETA(NAME) any text (no spaces between ETA and name or around name)</p></li>
<li><p>; any text ETA &lt;on|ON&gt; NAME any text (exactly one space between the words)</p></li>
</ol>
<p>Any combination of those in one line must work:</p>
<div class="highlight-Bash notranslate"><div class="highlight"><pre><span></span>&lt;some<span class="w"> </span>complex<span class="w"> </span>definition&gt;<span class="w"> </span><span class="p">;</span><span class="w"> </span>name1<span class="w"> </span><span class="p">;</span><span class="w"> </span>name2<span class="w"> </span><span class="p">;</span><span class="w"> </span>also<span class="w"> </span>ETA<span class="o">(</span>name3<span class="o">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span>be<span class="w"> </span>aware<span class="w"> </span>that<span class="w"> </span>numbers<span class="w"> </span>count<span class="w"> </span>as<span class="w"> </span>well:<span class="w"> </span>ETA<span class="o">(</span><span class="m">4</span><span class="o">)</span>
</pre></div>
</div>
<p>Here we have 4 variables (ETAs) which can be referred to as ETA 1 to 4.
Keep in mind that every ETA(name) in the model text is replaced with ETA(&lt;number&gt;), even inside the definition block.</p>
<p>If this is not what you want, you may define it using another notation, or add something to the comment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>D = ETA(D1)*ETA(C)*ETA(A)*ETA(D2)
$OMEGA
0.1 ; ETA(D1)
0.1 ; A
0.1 ; ETA ON C
0.1 ; ETA(D2) D2 or ETA ON D2 or any other way that doesn&#39;t look like another definition
</pre></div>
</div>
<p>Which then becomes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>D = ETA(1)*ETA(3)*ETA(2)*ETA(4)
$OMEGA
0.1 ; ETA(1)
0.1 ; A
0.1 ; ETA ON C
0.1 ; ETA(4) D2 or ETA ON D2
</pre></div>
</div>
<p>Parenthesis with (lower bound, initial value, upper bound) may also be used, as illustrated below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$PK
D = THETA(1)*THETA(3)*THETA(2)*THETA(4)
$OMEGA
(0,0.1,10) ; THETA(1)
(0,0.1) ; THETA(A)
(0.1) ; THETA(3)
0.1 ; THETA(4)
</pre></div>
</div>
</section>
</section>
<section id="tokens-file">
<span id="tokens-file-target"></span><h3>Tokens File<a class="headerlink" href="#tokens-file" title="Permalink to this heading">¶</a></h3>
<p>The tokens file provides a dictionary (as a JSON file) of token key-text pairs. The highest level of the dictionary is the <a class="reference internal" href="Glossary.html#token-group"><span class="std std-ref">token group</span></a>. Token groups are
defined by a unique <a class="reference internal" href="Glossary.html#token-stem"><span class="std std-ref">token stem</span></a>. The token stem also typically serves as the key in the <a class="reference internal" href="Glossary.html#token-key-text-pair"><span class="std std-ref">token key-text pairs.</span></a> The token stem is
a text string that corresponds to the token key that appears in the <a class="reference internal" href="Glossary.html#template"><span class="std std-ref">template file</span></a>.
The 2nd level in the tokens dictionary is the <a class="reference internal" href="Glossary.html#token-set"><span class="std std-ref">token sets</span></a>. In the template file the tokens are indexed (e.g., ADVAN[1]), as typically multiple token keys
will need to be replaced by text to create correct syntax. For example, if the search is for 1 compartment (ADVAN1) vs 2 compartment (ADVAN3), for ADVAN3, definitions of K23
and K32 must be provided in the $PK block, and (typically) initial estimates must be provided in the $THETA block. Thus, a set of 3 replacements must be made, one in $SUBS,
one in $PK, and one in $THETA. So, the token set for selection of number of compartments, for 1 compartment (first option) or 2 compartments (second option),
will include the following JSON code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;ADVAN&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;ADVAN1 &quot;</span><span class="p">,</span>
                <span class="s2">&quot;;; 1 compartment, no definition needed for K12 or K21 &quot;</span><span class="p">,</span>
                <span class="s2">&quot;;; 1 compartment, no initial estimate needed for K12 or K21&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;ADVAN3 &quot;</span><span class="p">,</span>
                <span class="s2">&quot; K12 = THETA(ADVANA) ;; 2 compartment, need definition for K12 </span><span class="se">\n</span><span class="s2"> K21 = THETA(ADVANB)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;  (0,0.5) ;; K12 THETA(ADVANA)  </span><span class="se">\n</span><span class="s2">  (0,0.5) ;; K21 THETA(ADVANB) &quot;</span>
            <span class="p">],</span>
</pre></div>
</div>
<p>Note that specification of the current model as one compartment or two is done by the search algorithm and provided in the model <a class="reference internal" href="Glossary.html#phenotype"><span class="std std-ref">phenotype</span></a>.</p>
<p>A diagram of the token structure is given below</p>
<figure class="align-default">
<img alt="_images/tokens.png" src="_images/tokens.png" />
</figure>
<p>Note the “nested token” – a token (“{K23~WT[1]}”) within a token, circled in red. Any number of levels of nested tokens is permitted (but the logic becomes very difficult with more than one).
pyDarwin will first substitute the full text
into the template, then scans the resulting text again. This nested token will then be found and the text from the {K23~WT[1]} token set will be substituted.</p>
<p>Several notes:</p>
<p>1. The <a class="reference internal" href="Glossary.html#token-stem"><span class="std std-ref">token stem</span></a> is “ADVAN” and identifies the <a class="reference internal" href="Glossary.html#token-group"><span class="std std-ref">token group</span></a>. This stem must be unique in the token groups. The token stem also typically
serves as the token key in the <a class="reference internal" href="Glossary.html#token-key-text-pair"><span class="std std-ref">token key-value pairs</span></a>. In this example, three replacements must be made in the template, in $SUBS, $PK, and $THETA.
In the template file, these will be coded as {ADVAN[1]}, {ADVAN[2]}, and {ADVAN[3]}. Note the curly braces, these are required in the template, but not the tokens file.
The indices correspond to the indices of the <a class="reference internal" href="Glossary.html#token"><span class="std std-ref">tokens</span></a> in the token set. In this case there are 3 <a class="reference internal" href="Glossary.html#token-key-text-pair"><span class="std std-ref">token key-value pairs</span></a> in each token set.
There may be additional unused tokens (as may be the case with <a class="reference internal" href="Glossary.html#nested-tokens"><span class="std std-ref">nested tokens</span></a>) but each token in the template file must have a corresponding token key-value pair in the tokens file.
There are 2 token sets in this token group, one coding for ADVAN1 and one coding for ADVAN3.</p>
<ol class="arabic simple" start="2">
<li><p>New lines in JSON files are ignored. To code a new line, enter the newline escape character “\n”. Similarly, a tab is coded as “\t”.</p></li>
<li><p>Comments are not permitted in JSON files. However, comments for the generated NMTRAN control file maybe included with the usual syntax “;”.</p></li>
<li><p>There is no dependency on the sequence of token sets in the file, any order is acceptable, they need not be in the same order as they appear in the <a class="reference internal" href="#template-file-target"><span class="std std-ref">template file.</span></a></p></li>
<li><p>All other <a class="reference external" href="https://www.json.org/json-en.html">JSON</a> rules apply.</p></li>
</ol>
<p><strong>Special note on initial estimates</strong></p>
<p>In order to parse the text in the initial estimates blocks (THETA, OMEGA, and SIGMA) the user MUST include token stem text as a NONMEM/NMTRAN comment (i.e., after “;”). There is
no other way to identify which initial estimates are to be associated with which THETA.
For example, if a token stem has two THETAs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Effect</span> <span class="o">=</span> <span class="n">THETA</span><span class="p">(</span><span class="n">EMAX</span><span class="p">)</span> <span class="o">*</span> <span class="n">CONC</span><span class="o">/</span><span class="p">(</span><span class="n">THETA</span><span class="p">(</span><span class="n">EC50</span><span class="p">)</span> <span class="o">+</span> <span class="n">CONC</span><span class="p">)</span>
</pre></div>
</div>
<p>for the text in the $PK block, then code to be put into the $THETA block will be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;  (0,100) </span><span class="se">\t</span><span class="s2">; THETA(EMAX) &quot;</span>
<span class="s2">&quot;  (0,1000) </span><span class="se">\t</span><span class="s2">; THETA(EC50) &quot;</span>
</pre></div>
</div>
<p>Where \t is a tab. Without this THETA(EMAX) and THETA(EC50) as a comment, there would not be any way to identify which initial estimate is to be associated with which
THETA. Note that NONMEM assigns THETAs by sequence of appearance in $THETA. Given that the actual indices for THETA cannot be determined until the control file
is created, this approach would lead to ambiguity. Each initial estimate must be on a new line and include the THETA (or ETA or EPS) + parameter identifier.</p>
</section>
<section id="options-file">
<span id="options-file-target"></span><h3>Options File<a class="headerlink" href="#options-file" title="Permalink to this heading">¶</a></h3>
<p>A JSON file with key-value pairs specifying various options for executing pyDarwin. While some fields are mandatory, some are
algorithm-specific, while others are only relevant for execution on Linux Grids.</p>
<p>See <a class="reference internal" href="Options.html#options"><span class="std std-ref">Options List</span></a> for details.</p>
</section>
</section>
<section id="searching-omega-structure">
<span id="omega-search-usage-target"></span><h2>Searching Omega Structure<a class="headerlink" href="#searching-omega-structure" title="Permalink to this heading">¶</a></h2>
<p>In addition to specifying relations inside the <a class="reference internal" href="#template-file-target"><span class="std std-ref">template file</span></a> and <a class="reference internal" href="#tokens-file-target"><span class="std std-ref">tokens file</span></a> to define
the search space, you may also search for different structures of the omega matrix given fields specified in <a class="reference internal" href="Options.html#options"><span class="std std-ref">options.json</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Omega structure alone can be searched without any tokens for compartments, covariates, etc.
If searching Omega submatrices, options for Omega band/block search must be additionally specified.</p>
</div>
<p>Omega structure is encoded by a set of separate genes: one of the genes represents the omega block pattern, another one is for the band width (only applicable to NONMEM models). The pattern is the index of a valid pattern composed by pyDarwin.</p>
<p>In case of independent omega search, the set is repeated as many times as the number of search blocks in the template.</p>
<p>Valid patterns are created based on the maximum omega search block length and maximum size of submatrices (specified through <a class="mono reference internal" href="Options.html#max-omega-sub-matrix-options-desc"><span class="std std-ref">max_omega_sub_matrix</span></a>, see <a class="reference internal" href="#omega-submatrices-search-target"><span class="std std-ref">Omega Submatrices Search</span></a> for details) if applicable. For example, for search_block(A, B, C, D, E) and max_omega_sub_matrix = 4, pyDarwin will consider the following 16 patterns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">()</span>
<span class="p">(</span><span class="n">A</span> <span class="n">B</span> <span class="n">C</span> <span class="n">D</span> <span class="n">E</span><span class="p">)</span>
<span class="p">(</span><span class="n">A</span> <span class="n">B</span><span class="p">)</span>
<span class="p">(</span><span class="n">A</span> <span class="n">B</span><span class="p">)</span> <span class="p">(</span><span class="n">C</span> <span class="n">D</span><span class="p">)</span>
<span class="p">(</span><span class="n">A</span> <span class="n">B</span><span class="p">)</span> <span class="p">(</span><span class="n">C</span> <span class="n">D</span> <span class="n">E</span><span class="p">)</span>
<span class="p">(</span><span class="n">A</span> <span class="n">B</span><span class="p">)</span> <span class="p">(</span><span class="n">D</span> <span class="n">E</span><span class="p">)</span>
<span class="p">(</span><span class="n">A</span> <span class="n">B</span> <span class="n">C</span><span class="p">)</span>
<span class="p">(</span><span class="n">A</span> <span class="n">B</span> <span class="n">C</span><span class="p">)</span> <span class="p">(</span><span class="n">D</span> <span class="n">E</span><span class="p">)</span>
<span class="p">(</span><span class="n">A</span> <span class="n">B</span> <span class="n">C</span> <span class="n">D</span><span class="p">)</span>
<span class="p">(</span><span class="n">B</span> <span class="n">C</span><span class="p">)</span>
<span class="p">(</span><span class="n">B</span> <span class="n">C</span><span class="p">)</span> <span class="p">(</span><span class="n">D</span> <span class="n">E</span><span class="p">)</span>
<span class="p">(</span><span class="n">B</span> <span class="n">C</span> <span class="n">D</span><span class="p">)</span>
<span class="p">(</span><span class="n">B</span> <span class="n">C</span> <span class="n">D</span> <span class="n">E</span><span class="p">)</span>
<span class="p">(</span><span class="n">C</span> <span class="n">D</span><span class="p">)</span>
<span class="p">(</span><span class="n">C</span> <span class="n">D</span> <span class="n">E</span><span class="p">)</span>
<span class="p">(</span><span class="n">D</span> <span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
<p>Here the empty pattern, <code class="docutils literal notranslate"><span class="pre">()</span></code>, means there is no block Omega  (i.e., everything is diagonal), and the variables enclosed by the parenthesis are the ones whose associated covariance matrix (Omega) is block (that is, for each pattern, only those variables whose Omega matrix is block are listed). For NONMEM models without submatrix search, the empty pattern is substituted with an extra value for band width gene (= 0).</p>
<p>The number of patterns for different combinations of <a class="mono reference internal" href="Options.html#max-omega-search-len-options-desc"><span class="std std-ref">max_omega_search_len</span></a> (whose values listed in the first column) and <a class="mono reference internal" href="Options.html#max-omega-sub-matrix-options-desc"><span class="std std-ref">max_omega_sub_matrix</span></a> (whose values listed in the first row) can be found in the table below.</p>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Number of patterns</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>4</p></th>
<th class="head"><p>5</p></th>
<th class="head"><p>6</p></th>
<th class="head"><p>7</p></th>
<th class="head"><p>8</p></th>
<th class="head"><p>9</p></th>
<th class="head"><p>10</p></th>
<th class="head"><p>11</p></th>
<th class="head"><p>12</p></th>
<th class="head"><p>13</p></th>
<th class="head"><p>14</p></th>
<th class="head"><p>15</p></th>
<th class="head"><p>16</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>6</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>9</p></td>
<td><p>14</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>14</p></td>
<td><p>25</p></td>
<td><p>30</p></td>
<td><p>32</p></td>
<td><p>32</p></td>
<td><p>32</p></td>
<td><p>32</p></td>
<td><p>32</p></td>
<td><p>32</p></td>
<td><p>32</p></td>
<td><p>32</p></td>
<td><p>32</p></td>
<td><p>32</p></td>
<td><p>32</p></td>
<td><p>32</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>22</p></td>
<td><p>45</p></td>
<td><p>57</p></td>
<td><p>62</p></td>
<td><p>64</p></td>
<td><p>64</p></td>
<td><p>64</p></td>
<td><p>64</p></td>
<td><p>64</p></td>
<td><p>64</p></td>
<td><p>64</p></td>
<td><p>64</p></td>
<td><p>64</p></td>
<td><p>64</p></td>
<td><p>64</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>35</p></td>
<td><p>82</p></td>
<td><p>109</p></td>
<td><p>121</p></td>
<td><p>126</p></td>
<td><p>128</p></td>
<td><p>128</p></td>
<td><p>128</p></td>
<td><p>128</p></td>
<td><p>128</p></td>
<td><p>128</p></td>
<td><p>128</p></td>
<td><p>128</p></td>
<td><p>128</p></td>
<td><p>128</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>56</p></td>
<td><p>150</p></td>
<td><p>209</p></td>
<td><p>237</p></td>
<td><p>249</p></td>
<td><p>254</p></td>
<td><p>256</p></td>
<td><p>256</p></td>
<td><p>256</p></td>
<td><p>256</p></td>
<td><p>256</p></td>
<td><p>256</p></td>
<td><p>256</p></td>
<td><p>256</p></td>
<td><p>256</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>90</p></td>
<td><p>275</p></td>
<td><p>402</p></td>
<td><p>465</p></td>
<td><p>493</p></td>
<td><p>505</p></td>
<td><p>510</p></td>
<td><p>512</p></td>
<td><p>512</p></td>
<td><p>512</p></td>
<td><p>512</p></td>
<td><p>512</p></td>
<td><p>512</p></td>
<td><p>512</p></td>
<td><p>512</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>145</p></td>
<td><p>505</p></td>
<td><p>774</p></td>
<td><p>913</p></td>
<td><p>977</p></td>
<td><p>1005</p></td>
<td><p>1017</p></td>
<td><p>1022</p></td>
<td><p>1024</p></td>
<td><p>1024</p></td>
<td><p>1024</p></td>
<td><p>1024</p></td>
<td><p>1024</p></td>
<td><p>1024</p></td>
<td><p>1024</p></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>234</p></td>
<td><p>928</p></td>
<td><p>1491</p></td>
<td><p>1794</p></td>
<td><p>1937</p></td>
<td><p>2001</p></td>
<td><p>2029</p></td>
<td><p>2041</p></td>
<td><p>2046</p></td>
<td><p>2048</p></td>
<td><p>2048</p></td>
<td><p>2048</p></td>
<td><p>2048</p></td>
<td><p>2048</p></td>
<td><p>2048</p></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>378</p></td>
<td><p>1706</p></td>
<td><p>2873</p></td>
<td><p>3526</p></td>
<td><p>3841</p></td>
<td><p>3985</p></td>
<td><p>4049</p></td>
<td><p>4077</p></td>
<td><p>4089</p></td>
<td><p>4094</p></td>
<td><p>4096</p></td>
<td><p>4096</p></td>
<td><p>4096</p></td>
<td><p>4096</p></td>
<td><p>4096</p></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>611</p></td>
<td><p>3137</p></td>
<td><p>5537</p></td>
<td><p>6931</p></td>
<td><p>7618</p></td>
<td><p>7937</p></td>
<td><p>8081</p></td>
<td><p>8145</p></td>
<td><p>8173</p></td>
<td><p>8185</p></td>
<td><p>8190</p></td>
<td><p>8192</p></td>
<td><p>8192</p></td>
<td><p>8192</p></td>
<td><p>8192</p></td>
</tr>
<tr class="row-odd"><td><p>15</p></td>
<td><p>988</p></td>
<td><p>5769</p></td>
<td><p>10672</p></td>
<td><p>13625</p></td>
<td><p>15110</p></td>
<td><p>15809</p></td>
<td><p>16129</p></td>
<td><p>16273</p></td>
<td><p>16337</p></td>
<td><p>16365</p></td>
<td><p>16377</p></td>
<td><p>16382</p></td>
<td><p>16384</p></td>
<td><p>16384</p></td>
<td><p>16384</p></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>1598</p></td>
<td><p>10610</p></td>
<td><p>20570</p></td>
<td><p>26785</p></td>
<td><p>29971</p></td>
<td><p>31490</p></td>
<td><p>32193</p></td>
<td><p>32513</p></td>
<td><p>32657</p></td>
<td><p>32721</p></td>
<td><p>32749</p></td>
<td><p>32761</p></td>
<td><p>32766</p></td>
<td><p>32768</p></td>
<td><p>32768</p></td>
</tr>
</tbody>
</table>
<p>By default, pyDarwin will try to search omega structure for each  search block/band individually. This is only possible if all search blocks are placed in the template. If any search block is found in the tokens, the omega search will be performed uniformly, i.e. all search blocks will have the same pattern.
Individual omega search will further increase the search space size. It can be turned off by setting <a class="mono reference internal" href="Options.html#individual-omega-search-options-desc"><span class="std std-ref">individual_omega_search</span></a> to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
<section id="omega-block-search">
<span id="omega-block-search-target"></span><h3>Omega Block Search<a class="headerlink" href="#omega-block-search" title="Permalink to this heading">¶</a></h3>
<p>Omega block search is only applicable to NLME models. It takes a diagonal Omega matrix and searches for a block Omega matrix.</p>
<p>To enable block search for NLME models,</p>
<ol class="arabic simple">
<li><p>Set <a class="mono reference internal" href="Options.html#search-omega-blocks-options-desc"><span class="std std-ref">search_omega_blocks</span></a> to <code class="docutils literal notranslate"><span class="pre">true</span></code> in the <a class="reference internal" href="#options-file-target"><span class="std std-ref">options file</span></a>.</p></li>
<li><p>Add one or more <code class="docutils literal notranslate"><span class="pre">#search_block(randomEffectList)</span></code> to the <a class="reference internal" href="#template-file-target"><span class="std std-ref">template file</span></a> and/or the <a class="reference internal" href="#tokens-file-target"><span class="std std-ref">tokens file</span></a>, where <code class="docutils literal notranslate"><span class="pre">randomEffectList</span></code> denotes the list of random effects that one wants to search whether their associated covariance matrix (Omega) is diagonal or block.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Only names, commas, and spaces (including tabs and new lines) are allowed inside the <code class="docutils literal notranslate"><span class="pre">#search_block</span></code>; no comments, no nested braces.</p></li>
<li><p>Only those random effects having diagonal Omegas are allowed inside the <code class="docutils literal notranslate"><span class="pre">search_block</span></code>; if you put some random effects having <code class="docutils literal notranslate"><span class="pre">block</span></code>/<code class="docutils literal notranslate"><span class="pre">same</span></code>/<code class="docutils literal notranslate"><span class="pre">fixed</span></code> Omega, pyDarwin will halt the search.</p></li>
<li><p>If there are random effects dependent (<code class="docutils literal notranslate"><span class="pre">same</span></code>) on the ones in the <code class="docutils literal notranslate"><span class="pre">#search_block</span></code>, pyDarwin will halt the search.</p></li>
<li><p>Random effects present in <code class="docutils literal notranslate"><span class="pre">#search_block</span></code> but absent in the model (i.e., not present in any <code class="docutils literal notranslate"><span class="pre">ranef</span></code> statement) will be ignored.</p></li>
</ul>
</div>
<p>When creating individual models, pyDarwin puts the new <code class="docutils literal notranslate"><span class="pre">ranef</span></code> statement below every <code class="docutils literal notranslate"><span class="pre">#search_block</span></code> and fills it with corresponding Omegas, and then removes the associated random effects from the original <code class="docutils literal notranslate"><span class="pre">ranef</span></code> statements (basically moves the Omegas from original <code class="docutils literal notranslate"><span class="pre">ranef</span></code> statement to the new one). Empty <code class="docutils literal notranslate"><span class="pre">diag</span></code> and <code class="docutils literal notranslate"><span class="pre">ranef</span></code> statements are removed from the model. For example, if a template contains</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ranef</span><span class="p">(</span><span class="n">diag</span><span class="p">(</span><span class="n">nV</span><span class="p">,</span> <span class="n">nCl</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>and the following statement is added to it</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#search_block(nV, nCl))</span>
</pre></div>
</div>
<p>with <code class="docutils literal notranslate"><span class="pre">search_omega_blocks</span></code> set to <code class="docutils literal notranslate"><span class="pre">true</span></code> in the options file, then pyDarwin will create two models with one having</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ranef</span><span class="p">(</span><span class="n">diag</span><span class="p">(</span><span class="n">nV</span><span class="p">,</span> <span class="n">nCl</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>and the other one having</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ranef</span><span class="p">(</span><span class="n">block</span><span class="p">(</span><span class="n">nV</span><span class="p">,</span> <span class="n">nCl</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="omega-band-search">
<h3>Omega Band Search<a class="headerlink" href="#omega-band-search" title="Permalink to this heading">¶</a></h3>
<p>Omega band search is only applicable to NONMEM models. It takes a diagonal OMEGA matrix and searches for band OMEGA matrices.</p>
<p>Band Omegas will be searched if:</p>
<ol class="arabic">
<li><p>The text “; search band” appears on the $OMEGA record in the <a class="reference internal" href="#template-file-target"><span class="std std-ref">template file</span></a>.</p></li>
<li><p>The following fields have been included in the <a class="reference internal" href="#options-file-target"><span class="std std-ref">options file</span></a>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="Options.html#search-omega-bands-options-desc"><span class="std std-ref">“search_omega_bands”</span></a>: true</p></li>
<li><p><a class="reference internal" href="Options.html#max-omega-band-width-options-desc"><span class="std std-ref">“max_omega_band_width”</span></a>: N</p></li>
</ul>
<p>Where N is an positive integer.</p>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The $OMEGA must appear on a separate line, e.g,. <cite>$OMEGA 0.1 0.1 0.1 ; search band</cite>
is not permitted.</p>
</div>
<p>For example, if the Omega matrix specified in the template file is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$OMEGA ; search band
0.1
0.1
0.1
0.1
</pre></div>
</div>
<p>With <cite>“search_omega_bands”:true</cite> and <cite>“max_omega_band_width”: 3</cite> specified in the options file, the search space will consist
of candidate models with the following Omega structures:</p>
<ul class="simple">
<li><p>Width = 0</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$OMEGA BLOCK(4)
0.1
0 0.1
0 0 0.1
0 0 0 0.1
</pre></div>
</div>
<ul class="simple">
<li><p>Width = 1</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$OMEGA BLOCK(4)
0.1
p 0.1
0 p 0.1
0 0 p  0.1
</pre></div>
</div>
<ul class="simple">
<li><p>Width = 2</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$OMEGA BLOCK(4)
0.1
p 0.1
p p 0.1
0 p p  0.1
</pre></div>
</div>
<ul class="simple">
<li><p>Width = 3</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$OMEGA BLOCK(4)
0.1
p 0.1
p p 0.1
p p p  0.1
</pre></div>
</div>
<p>The actual value used for the off diagonal elements (p in example) are randomly chosen from a uniform distributions
between -p and +p where p is a value less than the maximum value that results in a positive definite matrix.
p will have a minimum absolute value of 0.000001 to ensure it does not have a value of 0. Each value of p in the matrix will
be different.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use <a class="mono reference internal" href="Options.html#random-seed-options-desc"><span class="std std-ref">random_seed</span></a> to ensure values of off diagonal elements are the same across
subsequent searches.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the user defines the OMEGA structure (e.g., DIAG, BLOCK, SAME) with <cite>;; search band</cite> included, this
will override the search option and the block will be used as specified in the template file, without any
OMEGA band search. The OMEGA block is assumed to be variance/covariance, CORRELATON  and CHOLESKY are not supported.</p>
</div>
<p>Note that each OMEGA in the template file can be set to searched or not searched, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$OMEGA      ;; search band
  0.6       ; ETA(1) K23
  0.5       ; ETA(2) K32
$OMEGA
  0.4       ; ETA(3) CLEARANCE
  0.3       ; ETA(4) VOLUME
  0.2       ; ETA(5) KA
</pre></div>
</div>
<p>In this case the first $OMEGA block will be searched and the second will not.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Comments can appear in the $OMEGA block but each row of the matrix must be on its own line.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not combine multiple OMEGA blocks in the template if some are BLOCK|DIAG|SAME|FIX and
others are to be searched.</p>
</div>
</section>
<section id="omega-submatrices-search">
<span id="omega-submatrices-search-target"></span><h3>Omega Submatrices Search<a class="headerlink" href="#omega-submatrices-search" title="Permalink to this heading">¶</a></h3>
<p>OMEGA submatrices permit a wider range of OMEGA structure, and, importantly, the option to estimate fewer off diagonal elements of OMEGA. In addition to the options specified above for Omega block search (for NLME models) or Omega band search (for NONMEM models), 2 additional options should be included in the <a class="reference internal" href="#options-file-target"><span class="std std-ref">options file</span></a>:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="Options.html#search-omega-sub-matrix-options-desc"><span class="std std-ref">“search_omega_sub_matrix”</span></a>: true</p></li>
<li><p><a class="reference internal" href="Options.html#max-omega-sub-matrix-options-desc"><span class="std std-ref">“max_omega_sub_matrix”</span></a>: N</p></li>
</ul>
</div></blockquote>
<p>Where N is the maximum size of an OMEGA submatrix, then submatrices will be searched. OMEGA submatrices are intended to be used with OMEGA block search (for NLME models) or Omega band search (for NONMEM models) to further expand the options for OMEGA structure. Specifically,</p>
<p>For the source OMEGA matrix of a NONMEM model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$OMEGA ;; search band
0.1
0.1
0.1
0.1
</pre></div>
</div>
<p>If band matrix search is used, for an OMEGA band width of 1, the OMEGA matrix would be:</p>
<ul class="simple">
<li><p>Width = 1</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$OMEGA BLOCK(4)
0.1
p 0.1
0 p 0.1
0 0 p  0.1
</pre></div>
</div>
<p>And with the additional sub matrix search used, this search would also include:</p>
<ul class="simple">
<li><p>Width = 1</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$OMEGA BLOCK(2)
0.1
p 0.1
$OMEGA BLOCK(2)
0.1
p  0.1
</pre></div>
</div>
<p>Resulting in one fewer variance parameters to be estimated (covariance of ETA(2) and ETA(3)).</p>
</section>
</section>
<section id="pydarwin-outputs">
<h2>pyDarwin Outputs<a class="headerlink" href="#pydarwin-outputs" title="Permalink to this heading">¶</a></h2>
<section id="console-output">
<h3>Console output<a class="headerlink" href="#console-output" title="Permalink to this heading">¶</a></h3>
<p>After the search command is submitted, pyDarwin first verifies that the following files and executables are available:</p>
<ol class="arabic simple">
<li><p>The template file</p></li>
<li><p>The tokens file</p></li>
<li><p>The options file</p></li>
<li><p>nmfe??.bat - executes NONMEM</p></li>
<li><p>The data file(s) for the first control that is initiated</p></li>
<li><p>If post run R code is requested, Rscript.exe</p></li>
</ol>
<p>The startup output also lists the location of:</p>
<ol class="arabic simple">
<li><p>Data dir - folder where datasets are located. It is recommended that this be an absolute path</p></li>
<li><p>Project working dir - folder where template, token and options files are located, this is not set by the user</p></li>
<li><p>Project temp dir - root folder where model file will be found, if the option is not set to remove them</p></li>
<li><p>Project output dir - folder where all the results files will be put, such as results.csv and Final* files</p></li>
<li><p>Where intermediate output will be written (e.g., u:/user/example2/output/results.csv)</p></li>
<li><p>Where models will be saved (e.g., u:/user/example2/working/models.json)</p></li>
<li><p>NMFE??.bat (Windows) or nmfe?? (Linux) file</p></li>
<li><p>Rscript.exe, if used</p></li>
</ol>
<p>pyDarwin provides verbose output about whether individual models have executed successfully.</p>
<p>A typical line of output might be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">16</span><span class="p">:</span><span class="mi">22</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span> <span class="n">Iteration</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Model</span>     <span class="mi">1</span><span class="p">,</span>       <span class="n">Done</span><span class="p">,</span>    <span class="n">fitness</span> <span class="o">=</span> <span class="mf">123.34</span><span class="p">,</span>    <span class="n">message</span> <span class="o">=</span>  <span class="n">No</span> <span class="n">important</span> <span class="n">warnings</span>
</pre></div>
</div>
<p>The columns in this output are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Time</span> <span class="n">of</span> <span class="n">completion</span><span class="p">]</span> <span class="n">Iteration</span> <span class="o">=</span> <span class="n">Iteration</span><span class="o">/</span><span class="n">generation</span><span class="p">,</span> <span class="n">Model</span>     <span class="n">Model</span> <span class="n">Number</span><span class="p">,</span>       <span class="n">Final</span> <span class="n">Status</span><span class="p">,</span>    <span class="n">fitness</span> <span class="o">=</span> <span class="n">fitness</span><span class="o">/</span><span class="n">reward</span><span class="p">,</span>    <span class="n">message</span> <span class="o">=</span>  <span class="n">Messages</span> <span class="kn">from</span> <span class="nn">NMTRAN</span>
</pre></div>
</div>
<p>If there are messages from NONMEM execution, these will also be written to the console, as well as if execution failed, and, if request, if R execution failed.</p>
<p>If the <a class="mono reference internal" href="Options.html#remove-temp-dir-options-desc"><span class="std std-ref">remove_temp_dir</span></a> is set to false, the NONMEM control file, output file and other key files can be found in <code class="docutils literal notranslate"><span class="pre">{temp_dir}/Iteration/Model</span> <span class="pre">Number</span></code> for debugging.</p>
</section>
<section id="file-output">
<h3>File output<a class="headerlink" href="#file-output" title="Permalink to this heading">¶</a></h3>
<p>The file output from pyDarwin is generated in real time. That is, as soon as a model is finished, the results are written to the results.csv and models.json files. Similarly,
messages (what appears on the console output) are written continuously to the messages.txt file.</p>
<section id="messages-txt">
<h4>Messages.txt<a class="headerlink" href="#messages-txt" title="Permalink to this heading">¶</a></h4>
<p>The messages.txt file will be found in the working directory. This file’s content is the same as the console output.</p>
</section>
<section id="models-json">
<h4>models.json<a class="headerlink" href="#models-json" title="Permalink to this heading">¶</a></h4>
<p>The models.json will contain the key output from all models that are run. This is not a very user-friendly file, as it is fairly complex json. The primary (maybe only) use
for this file is if a search is interrupted, it can be restarted, and the contents of this file read in, rather than rerunning all the models. If the goal is to make simple diagnostics
of the search progress, the results.csv file is likely more useful.</p>
</section>
<section id="results-csv">
<h4>results.csv<a class="headerlink" href="#results-csv" title="Permalink to this heading">¶</a></h4>
<p>The results.csv file contains key information about all models that are run in a more user-friendly format. This file can be used to make plots to monitor progress of the search
or to identify models that had unexpected results (crashes).</p>
</section>
</section>
<section id="file-structure-and-naming">
<h3>File Structure and Naming<a class="headerlink" href="#file-structure-and-naming" title="Permalink to this heading">¶</a></h3>
<p>NONMEM control, executable, and output file naming:</p>
<section id="saving-nonmem-outputs">
<h4>Saving NONMEM outputs<a class="headerlink" href="#saving-nonmem-outputs" title="Permalink to this heading">¶</a></h4>
<p>NONMEM generates a great deal of file output. For a search of perhaps up to 10,000 models, this can become an issue for disc space.
By default, key NONMEM output files are retained. Most temporary files (e.g., FDATA, FCON) and the temp_dir are always removed to save disc space.
In addition, the data file(s) are not copied to the run directory, but all models use the same copy of the data file(s).</p>
</section>
<section id="model-folder-naming">
<h4>Model/folder naming<a class="headerlink" href="#model-folder-naming" title="Permalink to this heading">¶</a></h4>
<p>A model stem is generated from the current generation/iteration and model number of the form NM_generation_model_num. For example, if this is iteration 2, model 3, the model stem would be
NM_2_3. For the 1 bit downhill, the model stem is NM_generationDdownhillstep_modelnum, and for the 2 bit local search the model stem is NM_generationSdownhillstepSearchStep_modelnum. Final downhill
model stem is NM_FNDDownhillStep_ModelNum. This model stem is then used to name the .exe file, the .mod file, the .lst file, etc. This results in unique names for all models in the search. Models
are also frequently duplicated. Duplicated files are not rerun, and so those will not appear in the file structure.</p>
<p>Run folders are similarly named for the generation/iteration and model number. Below is a folder tree for <a class="reference internal" href="Example2.html#startpk2"><span class="std std-ref">Example 2</span></a>.</p>
<figure class="align-default">
<img alt="_images/FileStructure.png" src="_images/FileStructure.png" />
</figure>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Install.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Mark Sale.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>