<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Example 4: PK Model, DMAG by GA with post-run R code &mdash; pyDarwin 1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example 5: PK Model, DMAG by GP" href="Example5.html" />
    <link rel="prev" title="Example 3: PK Model, ODE model" href="Example3.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> pyDarwin
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="Options.html">Options List</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example1.html">Example 1: PK Model, Trivial Exhaustive Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example2.html">Example 2: PK Model 2, Simulation model by GP with Python code</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example3.html">Example 3: PK Model, ODE model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Example 4: PK Model, DMAG by GA with post-run R code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-template-file">The Template file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-tokens-file">The Tokens file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-options-file">The Options file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#starting-the-search-and-command-line-output">Starting the search and command line output:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Example5.html">Example 5: PK Model, DMAG by GP</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example6.html">Example 6: PK Model, DMAG by RF with post-run Python code</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="Glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="Troubleshooting.html">Trouble shooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="Support.html">Support</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyDarwin</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Example 4: PK Model, DMAG by GA with post-run R code</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="example-4-pk-model-dmag-by-ga-with-post-run-r-code">
<h1>Example 4: PK Model, DMAG by GA with post-run R code<a class="headerlink" href="#example-4-pk-model-dmag-by-ga-with-post-run-r-code" title="Permalink to this heading">¶</a></h1>
<p id="startpk4">Example 4 is the first realistic model search example, with real data (courtesy of <a class="reference external" href="https:/pharmacy.buffalo.edu/content/pharmacy/faculty-staff/faculty-profile.html?ubit=robertbi">Dr. Rob Bies</a> and the
<a class="reference external" href="https://www.nimh.nih.gov/funding/clinical-research/practical/catie#:~:text=The%20NIMH%2Dfunded%20Clinical%20Antipsychotic,medications%20used%20to%20treat%20schizophrenia">CATIE study</a> ).
This search again uses <a class="reference internal" href="Glossary.html#nested-tokens"><span class="std std-ref">nested tokens</span></a>, as it searches whether K32 is a function of Weight, and 1 vs 2 vs 3 compartments.
Another important feature of example 4 is the use of post run R code. In this case, it was of interest to capture the Cmax value. The is no straightforward way to include a penalty for
missing the Cmax
in the NONMEM control stream. Therefore, the penalty for missing Cmax is added after the NONMEM run is complete. Any R code can be provided by the user, and should return a vector of two values. The
first is a real values penalty to be added to the fitness/reward. The 2nd is text that will be appended to NONMEM output file to desribe the results of the R code execution.</p>
<p>The penalty for missing the Cmax is essentially a <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/11381569/">Posterior Predictive Check (PPC)</a>. The template file includes two problems, first the estimation, then a
Simulation problem, to generate a table of the PPC.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$PROB SIMULATION FOR CMAX

$INPUT       ID TIME AMT {D1LAG[1]} DV MDV EVID WT AGE SEX BUN SCR OCC CRCL COV1 COV2
$DATA      {data_dir}/dmag_with_period.csv IGNORE=@  REWIND
$MSFI = MSF1
$SIMULATION (1) ONLYSIM
$TABLE REP ID TIME IOBS EVID  NOAPPEND NOPRINT FILE = SIM.DAT ONEHEADER NOAPPEND
</pre></div>
</div>
<p>User provided R code is the saved to a file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>library(dplyr)
orgdata &lt;-  read.table(&quot;ORG.DAT&quot;,skip=1,header=TRUE)
orgdata &lt;- orgdata[orgdata$EVID==0&amp;orgdata$TIME&lt;=24,] # only first 24 hours
simdata &lt;-  read.table(&quot;SIM.DAT&quot;,skip=1,header=TRUE) # only first 24 hours
simdata &lt;- simdata[orgdata$EVID==0&amp;orgdata$TIME&lt;=24,]
observed_maxes &lt;- orgdata %&gt;% group_by(ID) %&gt;%
summarise(max = max(DV))
sim_maxes &lt;- simdata %&gt;% group_by(ID) %&gt;% summarise(max = max(IOBS))
# penalty of 4 points for each % difference
obs_geomean = exp(mean(log(observed_maxes$max)))
sim_geomean = exp(mean(log(sim_maxes$max)))
penalty &lt;- 4*abs((obs_geomean-sim_geomean)/obs_geomean)*100
text &lt;- paste0(&quot;Observed day 1 Cmax geomean = &quot;, round(obs_geomean,1), &quot; simulated day 1 Cmax geo mean = &quot;, round(sim_geomean,1))
c(penalty,text)
</pre></div>
</div>
<p>The R code executes from the run directory of that model, so, for example, a model run in c:\pydarwin\example4\00\04, the ORG.DAT and SIM.DAT files will be written to
that directory and the R code can read from the same directory.</p>
<p>This R code returns a character vector of length 2. The first is a string that can be read as numeric (penalty) and the 2nd is a string that is appended to the
NONMEM output file, as a comment to document the output of the R code. The content of the 2nd element of the vector is entirely up to the user, it has no
impact on the pyDarwin process, it is just appended to the output file.</p>
<p>The first element of the return value is added to the fitness/reward value and is then used in the selection of subsequent populations just as any other penalty. The
penalty value and be any real value - including negative, but typically would be positive.</p>
<p>The post processing code options are given in the options file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;postprocess&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;use_r&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;post_run_r_code&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{project_dir}</span><span class="s2">/Cmaxppc.r&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rscript_path&quot;</span><span class="p">:</span> <span class="s2">&quot;c:</span><span class="se">\\</span><span class="s2">Program Files</span><span class="se">\\</span><span class="s2">R</span><span class="se">\\</span><span class="s2">R-4.1.3</span><span class="se">\\</span><span class="s2">bin</span><span class="se">\\</span><span class="s2">Rscript.exe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;r_timeout&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
    <span class="s2">&quot;use_python&quot;</span><span class="p">:</span> <span class="n">false</span>
</pre></div>
</div>
<p>include whether to use_r for post processing (true), the path to the R code, the path to rscript.exe and the timeout (r_timeout) after which the R sesssion will be terminated if not
complete and the <a class="reference internal" href="Glossary.html#crash-value"><span class="std std-ref">crash_value</span></a> added as the penalty.</p>
<p>The search space contains 1.66 million possible models, and searches:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 34%" />
<col style="width: 32%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Description</p></th>
<th class="head"><p>Token Stem</p></th>
<th class="head"><p>Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Number of compartments</p></td>
<td><p>ADVAN</p></td>
<td><p>1|2|3</p></td>
</tr>
<tr class="row-odd"><td><p>Is K23 related to weight?</p></td>
<td><p>K23~WT</p></td>
<td><p>Yes|No</p></td>
</tr>
<tr class="row-even"><td><p>Is there ETA on Ka?</p></td>
<td><p>KAETA</p></td>
<td><p>Yes|No</p></td>
</tr>
<tr class="row-odd"><td><p>Is V2 related to weight?</p></td>
<td><p>V2~WT</p></td>
<td><p>None|Power|exponential</p></td>
</tr>
<tr class="row-even"><td><p>Is V2 related to Gender?</p></td>
<td><p>V2~GENDER</p></td>
<td><p>Yes|No</p></td>
</tr>
<tr class="row-odd"><td><p>Is CL related to weight?</p></td>
<td><p>CL~WT</p></td>
<td><p>None|Power|exponential</p></td>
</tr>
<tr class="row-even"><td><p>Is CL related to Age?</p></td>
<td><p>CL~AGE</p></td>
<td><p>Yes|No</p></td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Is there ETA on D1 and/or</div>
<div class="line">and/or ALAG1 (nested</div>
<div class="line">the D1LAG token group)</div>
</div>
</td>
<td><div class="line-block">
<div class="line">ETAD1LAG</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">None or ETA on D1 or ETA</div>
<div class="line">ETA on ALAGa or ETA on</div>
<div class="line">both or on both (BLOCK)</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>1,2,3 compartments</p>
<p>Between occasion variability</p>
<p>Multiple covaraiates (but probably still not as many as a real search)</p>
<p>Different absorption models</p>
<p>Different residual error models</p>
<p>Block OMEGA structures</p>
<p>Different initial estimates (also likely not as many as a real search should include).</p>
<p>As the search space is large, we’ll plan a fairly large sample (Population size of 80 with 12 generations). While <a class="reference internal" href="Overview.html#gp-desc"><span class="std std-ref">Gaussian Process</span></a> may be more efficient
in terms of number of models to convegence, once ~500 samples are defined, the <a class="reference external" href="https://scikit-optimize.github.io/stable/modules/optimizer.html#">ask step</a> becomes long, negating any
in effeciency of the algorithm.
Below is a table of the ask and tell step times  (hh:mm:ss), by iteration for GP. The sample size ws 80, with 4 chains on a 4 core computer:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 32%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>iteration</p></th>
<th class="head"><p>ask</p></th>
<th class="head"><p>tell</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td></td>
<td><p>0:00:15</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>0:01:18</p></td>
<td><p>0:00:35</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>0:03:12</p></td>
<td><p>0:01:03</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>0:05:56</p></td>
<td><p>0:01:55</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>0:09:33</p></td>
<td><p>0:03:55</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>0:16:22</p></td>
<td><p>0:04:47</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>0:25:25</p></td>
<td><p>0:08:30</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>0:33:43</p></td>
<td><p>0:09:30</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>0:50:11</p></td>
<td><p>0:10:26</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>0:55:32</p></td>
<td><p>0:13:52</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>1:09:00</p></td>
<td><p>0:17:14</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>1:22:18</p></td>
<td><p>0:21:14</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>1:40:25</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>In contrast, GA execution time for the next generation sample is short (a few seconds) and independent of the cumulative sample size.</p>
<section id="the-template-file">
<h2>The Template file<a class="headerlink" href="#the-template-file" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$PROBLEM    2 compartment fitting
$INPUT       ID TIME AMT {D1LAG[1]} DV MDV EVID WT AGE SEX BUN SCR OCC CRCL COV1 COV2

$DATA      {data_dir}/dmag_with_period.csv IGNORE=@

$SUBROUTINE {ADVAN[1]}
$PK
CWTKGONE = WT/81  ;; WEIGHT CENTERED ON ONE
CWTKGZERO = WT-81 ;; WEIGHT CENTERED ON ZERO
CAGE = AGE/60     ;; AGE CENTERED ON ONE
CCRCL = CRCL/85.6 ;; CRCL CENTERD ON ONE
CCOV1 = COV1-15.4 ;; COVARIATE 1 CENTERED ON ZERO
{IOVV[1]}
TVV2=THETA(1) {V2~WT[1]} {V2~SEX[1]} {V2~AGE[1]} {V2~COV2[1]}  *EXP(IOVV)
V2=TVV2*EXP(ETA(2))
{IOVCL[1]}
TVCL= {INITCL[1]} {CL~WT[1]} {CL~AGE[1]} {CL~CRCL[1]} {CL~COV1[1]} *EXP(IOVCL)
CL=TVCL*EXP(ETA(1))

K=CL/V2
{ADVAN[2]}
{D1LAG[2]}
TVKA=THETA(2)
KA=TVKA  {KAETA[1]}
S2 = V2
$ERROR
REP = IREP
IPRED =F
IOBS = F {RESERR[1]}
Y=IOBS
$THETA
(0.001,100)         ; THETA(1) V  UNITS = L
(0.001, 10)         ; THETA(2) KA UNITS = 1/HR
{INITCL[2]} ; THETA(INITCL) CL UNITS =  L/HR
{ADVAN[3]}
{V2~WT[2]}
{V2~SEX[2]}
{V2~AGE[2]}
{V2~COV2[2]}
{CL~WT[2]}
{CL~AGE[2]}
{CL~CRCL[2]}
{CL~COV1[2]}
{D1LAG[3]}
$OMEGA
0.1                 ; ETA(1) CLEARANCE
0.4                 ; ETA(2) VOLUME
{KAETA[2]}
{D1LAG[4]}
{IOVCL[2]}
{IOVV[2]}
$SIGMA
{RESERR[2]}

$EST METHOD=COND INTER MAX = 9999 MSFO=MSF1 PRINT = 10
$COV UNCOND PRINT=E  PRECOND=1 PRECONDS=TOS  MATRIX = R

$TABLE REP ID TIME DV EVID NOPRINT FILE = ORG.DAT ONEHEADER NOAPPEND

$PROB SIMULATION FOR CMAX

$INPUT       ID TIME AMT {D1LAG[1]} DV MDV EVID WT AGE SEX BUN SCR OCC CRCL COV1 COV2
$DATA      {data_dir}/dmag_with_period.csv IGNORE=@  REWIND
$MSFI = MSF1
$SIMULATION (1) ONLYSIM
$TABLE REP ID TIME IOBS EVID  NOAPPEND NOPRINT FILE = SIM.DAT ONEHEADER NOAPPEND
</pre></div>
</div>
<p>Example 4 template file <a class="reference download internal" download="" href="_downloads/939d2c00e4f1216895837aaab1abc1bd/template.txt"><code class="xref download docutils literal notranslate"><span class="pre">text</span></code></a></p>
</section>
<section id="the-tokens-file">
<h2>The Tokens file<a class="headerlink" href="#the-tokens-file" title="Permalink to this heading">¶</a></h2>
<p>Nothing new in the tokens file, we see again the nested tokens.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;ADVAN&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;ADVAN2 ;; advan2&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;;; PK 1 compartment &quot;</span><span class="p">,</span>
                    <span class="s2">&quot;;; THETA 1 compartment&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;ADVAN4 ;; advan4&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;K23=THETA(ADVANA){K23~WT[1]}</span><span class="se">\n</span><span class="s2">  K32=THETA(ADVANB){K23~WT[1]}&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(0.001,0.02)  </span><span class="se">\t</span><span class="s2"> ; THETA(ADVANA) K23 </span><span class="se">\n</span><span class="s2"> (0.001,0.3) </span><span class="se">\t</span><span class="s2"> ; THETA(ADVANB) K32 </span><span class="se">\n</span><span class="s2">{K23~WT[2]} </span><span class="se">\t</span><span class="s2"> ; init for K23~WT &quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;ADVAN12 ;; advan12&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;K23=THETA(ADVANA){K23~WT[1]}</span><span class="se">\n</span><span class="s2">  K32=THETA(ADVANB){K23~WT[1]}</span><span class="se">\n</span><span class="s2">  K24=THETA(ADVANC)</span><span class="se">\n</span><span class="s2">  K42=THETA(ADVAND)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(0.001,0.1) </span><span class="se">\t</span><span class="s2">; THETA(ADVANA) K23 </span><span class="se">\n</span><span class="s2"> (0.001,0.1)</span><span class="se">\t</span><span class="s2">; THETA(ADVANB) K32 </span><span class="se">\n</span><span class="s2"> (0.001,0.1) </span><span class="se">\t</span><span class="s2">; THETA(ADVANC) K24  </span><span class="se">\n</span><span class="s2"> (0.001,0.1) </span><span class="se">\t</span><span class="s2">; THETA(ADVAND) K42  </span><span class="se">\n</span><span class="s2"> {K23~WT[2]} </span><span class="se">\t</span><span class="s2"> ;; init for K23~WT&quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;K23~WT&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
             <span class="s2">&quot;&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*CWTKGONE**THETA(K23~WT)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(0,0.1) </span><span class="se">\t</span><span class="s2">; THETA(K23~WT) K23~WT&quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;KAETA&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
             <span class="s2">&quot;&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*EXP(ETA(KAETA)) &quot;</span><span class="p">,</span>
                    <span class="s2">&quot;$OMEGA ;; 2nd OMEGA block </span><span class="se">\n</span><span class="s2">0.1</span><span class="se">\t\t</span><span class="s2">; ETA(KAETA) ETA ON KA&quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;V2~WT&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
             <span class="s2">&quot;&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*CWTKGONE**THETA(V2~WT)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(-4,0.8) </span><span class="se">\t</span><span class="s2">; THETA(V2~WT) POWER volume ~WT &quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*EXP(CWTKGZERO*THETA(V2~WT))&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(-1,0.01) </span><span class="se">\t</span><span class="s2">; THETA(V2~WT) EXPONENTIAL volume ~WT &quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;V2~AGE&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
             <span class="s2">&quot;&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*CAGE**THETA(V2~AGE)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(-4,0.8) </span><span class="se">\t</span><span class="s2">; THETA(V2~AGE) POWER volume ~AGE &quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>

    <span class="s2">&quot;V2~SEX&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*EXP(SEX*THETA(V2~SEX))&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(-4,0.1) </span><span class="se">\t</span><span class="s2">; THETA(V2~SEX) EXPONENTIAL volume~SEX &quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;V2~COV2&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*EXP(COV2*THETA(V2~COV2))&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(-4,0.1) </span><span class="se">\t</span><span class="s2">; THETA(V2~COV2) EXPONENTIAL volume ~COV2 &quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;CL~WT&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*CWTKGONE**THETA(CL~WT)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(-4,.7) </span><span class="se">\t</span><span class="s2">; THETA(CL~WT) POWER clearance~WT &quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*EXP(CWTKGZERO*THETA(CL~WT))&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(-1,0.01) </span><span class="se">\t</span><span class="s2">; THETA(CL~WT) EXPONENTIAL clearance~WT &quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;CL~AGE&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*CAGE**THETA(CL~AGE)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(-4,.7) </span><span class="se">\t</span><span class="s2">; THETA(CL~AGE) POWER clearance~AGE &quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;CL~CRCL&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*CCRCL**THETA(CL~CRCL)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(-4,-0.2) </span><span class="se">\t</span><span class="s2">; THETA(CL~CRCL) POWER clearance~CRCL &quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;CL~COV1&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span>
            <span class="p">],</span>

            <span class="p">[</span><span class="s2">&quot;*EXP(CCOV1*THETA(CL~COV1))&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(-4,0.1) </span><span class="se">\t</span><span class="s2">; THETA(CL~COV1) EXPONENTIAL CL~COV1 &quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;IOVCL&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;IF(OCC.EQ.1) IOVCL = ETA(IOVCLA) </span><span class="se">\n</span><span class="s2">  IF(OCC.EQ.2) IOVCL = ETA(IOVCLB) </span><span class="se">\n</span><span class="s2">  IF(OCC.EQ.3) IOVCL = ETA(IOVCLC)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;$OMEGA BLOCK(1) ; ETA(IOVCLA)</span><span class="se">\n</span><span class="s2"> 0.1 </span><span class="se">\n</span><span class="s2"> $OMEGA BLOCK SAME ; ETA(IOVCLB)</span><span class="se">\n</span><span class="s2"> $OMEGA BLOCK SAME ; ETA(IOVCLC)&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;IOVCL = 0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;;; no iov ON CL&quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;IOVV&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;IF(OCC.EQ.1) IOVV = ETA(IOVVA) </span><span class="se">\n</span><span class="s2">  IF(OCC.EQ.2) IOVV = ETA(IOVVB) </span><span class="se">\n</span><span class="s2">  IF(OCC.EQ.3) IOVV = ETA(IOVVC)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;$OMEGA BLOCK(1) ; ETA(IOVVA)</span><span class="se">\n</span><span class="s2"> 0.1 </span><span class="se">\n</span><span class="s2">$OMEGA BLOCK SAME ; ETA(IOVVB)</span><span class="se">\n</span><span class="s2">$OMEGA BLOCK SAME ; ETA(IOVVC)&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;IOVV = 0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;;; no iov ON V&quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>

    <span class="s2">&quot;INITCL&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;THETA(INITCL)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;(0.001,2)&quot;</span>
       <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;THETA(INITCL)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;(0.001,20)&quot;</span>
    <span class="p">]</span>
  <span class="p">],</span>

    <span class="s2">&quot;ETAD1LAG&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*EXP(ETA(ETALAG))&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;$OMEGA ;; 3rd OMEGA block </span><span class="se">\n</span><span class="s2"> 0.1 </span><span class="se">\t\t</span><span class="s2">;; ETA(ETALAG) ETA ON ALAG1&quot;</span>
                    <span class="p">],</span>
                    <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;*EXP(ETA(ETALAG1))&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;$OMEGA ;;  </span><span class="se">\n</span><span class="s2"> 0.1 </span><span class="se">\t\t</span><span class="s2">;; ETA(ETALAG1) ETA ON D1&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*EXP(ETA(ETALAG1))&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;*EXP(ETA(ETALAG2))&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;$OMEGA  ;; diagonal OMEGA </span><span class="se">\n</span><span class="s2"> 0.1 </span><span class="se">\t\t</span><span class="s2">;; ETA(ETALAG1) ETA ON ALAG1</span><span class="se">\n</span><span class="s2"> 0.1 </span><span class="se">\t\t</span><span class="s2">;; ETA(ETALAG2) ETA ON D1&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;*EXP(ETA(ETALAG1))&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;*EXP(ETA(ETALAG2))&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;$OMEGA BLOCK(2) ;; block OMEGA block </span><span class="se">\n</span><span class="s2"> 0.1 </span><span class="se">\t\t</span><span class="s2">;; ETA(ETALAG1) ETA ON ALAG1</span><span class="se">\n</span><span class="s2"> 0.01 0.1 </span><span class="se">\t\t</span><span class="s2">;; ETA(ETALAG2) ETA ON D1&quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;D1LAG&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;DROP&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ALAG1=THETA(ALAG)</span><span class="si">{ETAD1LAG[1]}</span><span class="se">\n</span><span class="s2">;; No D1&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(0.001,0.1) </span><span class="se">\t</span><span class="s2">; THETA(ALAG) ALAG1   &quot;</span><span class="p">,</span>
                    <span class="s2">&quot;</span><span class="si">{ETAD1LAG[3]}</span><span class="s2">&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;RATE&quot;</span><span class="p">,</span>
                    <span class="s2">&quot; D1=THETA(D1) </span><span class="si">{ETAD1LAG[1]}</span><span class="s2"> ; infusion only&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(0.01,0.2) </span><span class="se">\t\t</span><span class="s2">;; THETA(D1) D1  &quot;</span><span class="p">,</span>
                    <span class="s2">&quot;</span><span class="si">{ETAD1LAG[3]}</span><span class="s2">  &quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;RATE&quot;</span><span class="p">,</span>
                    <span class="s2">&quot; ALAG1=THETA(ALAG)</span><span class="si">{ETAD1LAG[1]}</span><span class="se">\n</span><span class="s2">  D1=THETA(D1)</span><span class="si">{ETAD1LAG[2]}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;(0.001,0.1,1) </span><span class="se">\t\t</span><span class="s2">;; THETA(ALAG) ALAG1</span><span class="se">\n</span><span class="s2"> (0.001,0.1,1) ;;THETA(D1) D1&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;</span><span class="si">{ETAD1LAG[3]}</span><span class="s2"> </span><span class="se">\t\t</span><span class="s2">;; D1 and lag, block&quot;</span>
            <span class="p">]</span>
    <span class="p">],</span>
    <span class="s2">&quot;RESERR&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;*EXP(EPS(RESERRA))+EPS(RESERRB)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot; 0.1 </span><span class="se">\t</span><span class="s2">; EPS(RESERRA) proportional error</span><span class="se">\n</span><span class="s2">  100 </span><span class="se">\t</span><span class="s2">; EPS(RESERRB) additive error&quot;</span>
            <span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;+EPS(RESERRA)&quot;</span><span class="p">,</span>
                    <span class="s2">&quot; 200 </span><span class="se">\t</span><span class="s2">; EPS(RESERRA) additive error&quot;</span>
            <span class="p">]</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>NOTE AGAIN!!</strong>
The use of THETA(paremeter identifier), e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.02</span><span class="p">)</span>  \<span class="n">t</span> <span class="p">;</span> <span class="n">THETA</span><span class="p">(</span><span class="n">ADVANA</span><span class="p">)</span> <span class="n">K23</span>
</pre></div>
</div>
<p>for <strong>ALL</strong> initial estimate token text (THETA, OMEGA and SIGMA).</p>
<p>Example 4 tokens file <a class="reference download internal" download="" href="_downloads/83f6fbe41dca3bf36bb9a259487f1f4f/tokens.json"><code class="xref download docutils literal notranslate"><span class="pre">json</span></code></a></p>
</section>
<section id="the-options-file">
<h2>The Options file<a class="headerlink" href="#the-options-file" title="Permalink to this heading">¶</a></h2>
<p>The options file is fairly traditional, <a class="reference internal" href="Overview.html#ex-desc"><span class="std std-ref">Exhaustive search</span></a>.</p>
<p>The user should provide an appropriate path for <a class="reference internal" href="Options.html#nmfe-path-options-desc"><span class="std std-ref">“nmfe_path”</span></a>. NONMEM version 7.4 and 7.5 are supported.</p>
<p>Note that to run in the enviroment used for this example, the directories are set to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;working_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;u:/pyDarwin/example4/working&quot;</span><span class="p">,</span>
<span class="s2">&quot;temp_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;u:/pyDarwin/example4/rundir&quot;</span><span class="p">,</span>
<span class="s2">&quot;output_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;u:/pyDarwin/example4/output&quot;</span><span class="p">,</span>
</pre></div>
</div>
<p>It is recommended that the user set the directories to something appropriate for their enviroment. If directories are not set
the default is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">user_dir</span><span class="p">}</span>\<span class="n">pydarwin</span>\<span class="p">{</span><span class="n">project_name</span><span class="p">}</span>
</pre></div>
</div>
<p>In either case, the folder names are given in the initial and final output to facilitate finding the files and debuggins.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="s2">&quot;Certara&quot;</span><span class="p">,</span>
 <span class="s2">&quot;algorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;GA&quot;</span><span class="p">,</span>

 <span class="s2">&quot;GA&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;crossover_rate&quot;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">,</span>
     <span class="s2">&quot;elitist_num&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
     <span class="s2">&quot;mutation_rate&quot;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">,</span>
     <span class="s2">&quot;attribute_mutation_probability&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
     <span class="s2">&quot;mutate&quot;</span><span class="p">:</span> <span class="s2">&quot;flipBit&quot;</span><span class="p">,</span>
     <span class="s2">&quot;niche_penalty&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
     <span class="s2">&quot;selection&quot;</span><span class="p">:</span> <span class="s2">&quot;tournament&quot;</span><span class="p">,</span>
     <span class="s2">&quot;selection_size&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
     <span class="s2">&quot;sharing_alpha&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
     <span class="s2">&quot;crossover_operator&quot;</span><span class="p">:</span> <span class="s2">&quot;cxOnePoint&quot;</span>
 <span class="p">},</span>

 <span class="s2">&quot;random_seed&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
 <span class="s2">&quot;population_size&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
 <span class="s2">&quot;num_parallel&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
 <span class="s2">&quot;num_generations&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>

 <span class="s2">&quot;downhill_period&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
 <span class="s2">&quot;num_niches&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="s2">&quot;niche_radius&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="s2">&quot;local_2_bit_search&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
 <span class="s2">&quot;final_downhill_search&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>

 <span class="s2">&quot;crash_value&quot;</span><span class="p">:</span> <span class="mi">99999999</span><span class="p">,</span>

 <span class="s2">&quot;penalty&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;theta&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
     <span class="s2">&quot;omega&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
     <span class="s2">&quot;sigma&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
     <span class="s2">&quot;convergence&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
     <span class="s2">&quot;covariance&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
     <span class="s2">&quot;correlation&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
     <span class="s2">&quot;condition_number&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
     <span class="s2">&quot;non_influential_tokens&quot;</span><span class="p">:</span> <span class="mf">0.00001</span>
 <span class="p">},</span>

 <span class="s2">&quot;remove_run_dir&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>

 <span class="s2">&quot;nmfe_path&quot;</span><span class="p">:</span> <span class="s2">&quot;c:/nm744/util/nmfe74.bat&quot;</span><span class="p">,</span>
 <span class="s2">&quot;model_run_timeout&quot;</span><span class="p">:</span> <span class="mi">1200</span><span class="p">,</span>

 <span class="s2">&quot;postprocess&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;use_r&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
     <span class="s2">&quot;post_run_r_code&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{project_dir}</span><span class="s2">/Cmaxppc.r&quot;</span><span class="p">,</span>
     <span class="s2">&quot;rscript_path&quot;</span><span class="p">:</span> <span class="s2">&quot;c:</span><span class="se">\\</span><span class="s2">Program Files</span><span class="se">\\</span><span class="s2">R</span><span class="se">\\</span><span class="s2">R-4.1.3</span><span class="se">\\</span><span class="s2">bin</span><span class="se">\\</span><span class="s2">Rscript.exe&quot;</span><span class="p">,</span>
     <span class="s2">&quot;r_timeout&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
     <span class="s2">&quot;use_python&quot;</span><span class="p">:</span> <span class="n">false</span>
 <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>Example 4 options file <a class="reference download internal" download="" href="_downloads/dd612bb6e9e2d1663b19ca7c9a4d48fb/options.json"><code class="xref download docutils literal notranslate"><span class="pre">json</span></code></a></p>
<section id="starting-the-search-and-command-line-output">
<h3>Starting the search and command line output:<a class="headerlink" href="#starting-the-search-and-command-line-output" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="Usage.html#execution"><span class="std std-ref">Starting the search is covered here</span></a></p>
<p>Initialization output should look similar to this:</p>
<dl class="simple">
<dt>::</dt><dd><dl class="simple">
<dt>[05:46:53] Options file found at ..examplesuserExample4options.json</dt><dd><p>[05:46:53] Preparing project working folder…
[05:46:53] Preparing project output folder…
[05:46:53] Preparing project temp folder…
[05:47:21] Model run priority is below_normal
[05:47:21] Using darwin.MemoryModelCache
[05:47:21] Project dir: c:fdapyDarwinexamplesuserExample4
[05:47:21] Data dir: c:fdapyDarwinexamplesuserExample4
[05:47:21] Project working dir: u:/pyDarwin/example4/working
[05:47:21] Project temp dir: u:/pyDarwin/example4/rundir
[05:47:21] Project output dir: u:/pyDarwin/example4/output
[05:47:21] Writing intermediate output to u:/pyDarwin/example4/outputresults.csv
[05:47:21] Models will be saved in u:/pyDarwin/example4/workingmodels.json
[05:47:21] Template file found at ..examplesuserExample4template.txt
[05:47:21] Tokens file found at ..examplesuserExample4tokens.json
[05:47:21] Search start time = Mon Aug  1 05:47:21 2022
[05:47:21] – Starting Generation 0 –
[05:47:21] NMFE found: c:/nm744/util/nmfe74.bat
[05:47:21] RScript found at c:Program FilesRR-4.1.3binRscript.exe
[05:47:21] Post Run R code found at c:fdapyDarwinexamplesuserExample4Cmaxppc.r
[05:47:21] Not using Post Run Python code
[05:47:21] Checking files in u:pyDarwinexample4rundir0001
[05:47:21] Data set # 1 was found: c:fdapyDarwinexamplesuserExample4/dmag_with_period.csv
[05:47:21] Data set # 2 was found: c:fdapyDarwinexamplesuserExample4/dmag_with_period.csv</p>
</dd>
</dl>
</dd>
</dl>
<p>After a few seconds, the NONMEM execution should begind, with output simlar to this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">05</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">52</span><span class="p">]</span> <span class="n">Generation</span> <span class="o">=</span> <span class="mi">00</span><span class="p">,</span> <span class="n">Model</span>     <span class="mi">2</span><span class="p">,</span> <span class="n">Post</span> <span class="n">process</span> <span class="n">R</span> <span class="n">failed</span><span class="p">,</span>    <span class="n">fitness</span> <span class="o">=</span> <span class="mi">99999999</span><span class="p">,</span>    <span class="n">message</span> <span class="o">=</span> <span class="n">No</span> <span class="n">important</span> <span class="n">warnings</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">K32</span><span class="p">,</span> <span class="n">OR</span> <span class="n">K42</span> <span class="n">IS</span> <span class="n">TOO</span> <span class="n">CLOSE</span> <span class="n">TO</span> <span class="n">AN</span> <span class="n">EIGENVALUE</span>
<span class="p">[</span><span class="mi">05</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span> <span class="n">Generation</span> <span class="o">=</span> <span class="mi">00</span><span class="p">,</span> <span class="n">Model</span>     <span class="mi">3</span><span class="p">,</span> <span class="n">Post</span> <span class="n">process</span> <span class="n">R</span> <span class="n">failed</span><span class="p">,</span>    <span class="n">fitness</span> <span class="o">=</span> <span class="mi">99999999</span><span class="p">,</span>    <span class="n">message</span> <span class="o">=</span> <span class="n">NON</span><span class="o">-</span><span class="n">FIXED</span> <span class="n">OMEGA</span> <span class="n">NON</span><span class="o">-</span><span class="n">FIXED</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">K32</span><span class="p">,</span> <span class="n">OR</span> <span class="n">K42</span> <span class="n">IS</span> <span class="n">TOO</span> <span class="n">CLOSE</span> <span class="n">TO</span> <span class="n">AN</span> <span class="n">EIGENVALUE</span> <span class="n">OCCURS</span> <span class="n">DURING</span> <span class="n">SEARCH</span> <span class="n">FOR</span> <span class="n">ETA</span> <span class="n">AT</span> <span class="n">INITIAL</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">ETA</span><span class="o">=</span><span class="mi">0</span>
<span class="p">[</span><span class="mi">05</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">56</span><span class="p">]</span> <span class="n">Generation</span> <span class="o">=</span> <span class="mi">00</span><span class="p">,</span> <span class="n">Model</span>     <span class="mi">1</span><span class="p">,</span> <span class="n">Post</span> <span class="n">process</span> <span class="n">R</span> <span class="n">failed</span><span class="p">,</span>    <span class="n">fitness</span> <span class="o">=</span> <span class="mi">99999999</span><span class="p">,</span>    <span class="n">message</span> <span class="o">=</span> <span class="n">No</span> <span class="n">important</span> <span class="n">warnings</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">K32</span><span class="p">,</span> <span class="n">OR</span> <span class="n">K42</span> <span class="n">IS</span> <span class="n">TOO</span> <span class="n">CLOSE</span> <span class="n">TO</span> <span class="n">AN</span> <span class="n">EIGENVALUE</span>
<span class="p">[</span><span class="mi">06</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">41</span><span class="p">]</span> <span class="n">Generation</span> <span class="o">=</span> <span class="mi">00</span><span class="p">,</span> <span class="n">Model</span>     <span class="mi">7</span><span class="p">,</span> <span class="n">Post</span> <span class="n">process</span> <span class="n">R</span> <span class="n">failed</span><span class="p">,</span>    <span class="n">fitness</span> <span class="o">=</span> <span class="mi">99999999</span><span class="p">,</span>    <span class="n">message</span> <span class="o">=</span> <span class="n">NON</span><span class="o">-</span><span class="n">FIXED</span> <span class="n">OMEGA</span> <span class="n">NON</span><span class="o">-</span><span class="n">FIXED</span> <span class="n">PARAMETER</span>
</pre></div>
</div>
<p>Note that (as in the case of human generated NONMEM code) the first 4 models crash, and the <a class="reference internal" href="Glossary.html#crash-value"><span class="std std-ref">crash value</span></a> (99999999) is assigned
to the fitness. There also may be a message that “NON-FIXED OMEGA NON-FIXED PARAMETER”. This is a consequence of the nested tokens. With nested token
there commonly will be tokens that are not used, e.g., covariates relationships for K23 when a cone compartment model (ADVAN1) is selected. A small
penalty should be added (the non influential token penalty) in this case, simply to prefer this model over the same model without the non influential
token(s).</p>
<p>The final output from the search should look similar to this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">23</span><span class="p">:</span><span class="mi">04</span><span class="p">:</span><span class="mi">28</span><span class="p">]</span> <span class="n">Done</span> <span class="k">with</span> <span class="n">final</span> <span class="n">downhill</span> <span class="n">step</span><span class="o">.</span> <span class="n">best</span> <span class="n">fitness</span> <span class="o">=</span> <span class="mf">8504.69692879228</span>
<span class="p">[</span><span class="mi">23</span><span class="p">:</span><span class="mi">04</span><span class="p">:</span><span class="mi">28</span><span class="p">]</span> <span class="n">Final</span> <span class="n">output</span> <span class="kn">from</span> <span class="nn">best</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span><span class="o">/</span><span class="n">pyDarwin</span><span class="o">/</span><span class="n">example4</span><span class="o">/</span><span class="n">output</span>\<span class="n">FinalResultFile</span><span class="o">.</span><span class="n">lst</span>
<span class="p">[</span><span class="mi">23</span><span class="p">:</span><span class="mi">04</span><span class="p">:</span><span class="mi">28</span><span class="p">]</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">unique</span> <span class="n">models</span> <span class="n">to</span> <span class="n">best</span> <span class="n">model</span> <span class="o">=</span> <span class="mi">897</span>
<span class="p">[</span><span class="mi">23</span><span class="p">:</span><span class="mi">04</span><span class="p">:</span><span class="mi">28</span><span class="p">]</span> <span class="n">Time</span> <span class="n">to</span> <span class="n">best</span> <span class="n">model</span> <span class="o">=</span> <span class="mf">474.6</span> <span class="n">minutes</span>
<span class="p">[</span><span class="mi">23</span><span class="p">:</span><span class="mi">04</span><span class="p">:</span><span class="mi">28</span><span class="p">]</span> <span class="n">Best</span> <span class="n">overall</span> <span class="n">fitness</span> <span class="o">=</span> <span class="mf">8504.696929</span><span class="p">,</span> <span class="n">iteration</span> <span class="mi">05</span><span class="n">S071</span><span class="p">,</span> <span class="n">model</span> <span class="mi">90</span>
<span class="p">[</span><span class="mi">23</span><span class="p">:</span><span class="mi">04</span><span class="p">:</span><span class="mi">28</span><span class="p">]</span> <span class="n">Elapsed</span> <span class="n">time</span> <span class="o">=</span> <span class="mf">1015.4</span> <span class="n">minutes</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Example3.html" class="btn btn-neutral float-left" title="Example 3: PK Model, ODE model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Example5.html" class="btn btn-neutral float-right" title="Example 5: PK Model, DMAG by GP" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, ms.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>